# 基金价值估算系统使用说明

## 功能说明

本系统使用AkShare真实API获取基金持仓数据和股票实时行情，自动估算基金的实时涨跌幅。

## 启动步骤

### 1. 启动后端服务（使用真实AkShare数据）

```bash
cd c:/Users/Administrator/Desktop/FundValue
python backend/fund_api.py
```

服务启动后会显示：
```
启动基金API服务...
==================================================
服务地址: http://localhost:8000
API文档: 请查看 backend/README.md
==================================================
```

### 2. 前端服务（已自动运行）

访问地址：http://localhost:5173

## 使用的AkShare API

### 1. 基金持仓数据
- **API**: `ak.fund_portfolio_hold_em()`
- **数据源**: 天天基金网
- **功能**: 获取基金的股票持仓明细
- **参数**:
  - `symbol`: 基金代码（6位数字）
  - `date`: 年份（如"2024"）
- **返回字段**:
  - 股票代码
  - 股票名称
  - 占净值比例
  - 持股数量
  - 持仓市值
  - 季度

### 2. 股票实时行情
- **API**: `ak.stock_zh_a_spot_em()`
- **数据源**: 东方财富网
- **功能**: 获取沪深京A股实时行情
- **返回字段**:
  - 最新价
  - 开盘价
  - 最高价
  - 最低价
  - 昨收价
  - 涨跌幅
  - 涨跌额
  - 成交量
  - 成交额
  - 市盈率
  - 市净率

## API接口说明

### 后端接口

#### 1. 获取基金持仓
```
GET /api/fund/holdings?fundCode=000001
```

**响应示例**:
```json
{
  "fundCode": "000001",
  "holdings": [
    {
      "stockCode": "000001.XSHE",
      "stockName": "平安银行",
      "shares": 10000,
      "costPrice": 0,
      "holdPercent": 8.5,
      "marketValue": 125000,
      "quarter": "2024-09-30"
    }
  ]
}
```

#### 2. 获取股票价格
```
POST /api/stock/prices
Content-Type: application/json

{
  "codes": ["000001.XSHE", "000002.XSHE"]
}
```

**响应示例**:
```json
{
  "000001.XSHE": {
    "open": 12.50,
    "close": 12.80,
    "high": 12.90,
    "low": 12.40,
    "preClose": 12.40,
    "changePercent": 2.40,
    "change": 0.40,
    "volume": 12500000,
    "amount": 156000000,
    "pe": 5.5,
    "pb": 0.8
  }
}
```

#### 3. 健康检查
```
GET /api/health
```

## 数据说明

### 基金持仓数据
- **更新频率**: 季度更新（3/6/9/12月底）
- **数据延迟**: 约为1-2个月
- **注意事项**: 最新持仓数据需要等待季报披露

### 股票实时行情
- **更新频率**: 实时（交易时间内）
- **交易时间**:
  - 周一至周五
  - 上午: 9:30-11:30
  - 下午: 13:00-15:00
- **注意事项**: 非交易时间显示为收盘价

### 缓存机制
- 股票行情缓存时间: 5分钟
- 避免频繁请求API，提高响应速度

## 使用方法

### 1. 查询基金
1. 访问 http://localhost:5173
2. 点击"基金估算"
3. 输入基金代码（如：000001）
4. 点击"查询"按钮

### 2. 查看结果
- **估算涨跌幅**: 根据持仓股票加权计算
- **持仓明细**: 列表展示所有持仓股票
  - 股票名称
  - 当前涨幅（红涨绿跌）
  - 持仓占比
  - 较上期（暂不提供）

### 3. 支持的基金代码
- 6位数字基金代码
- 示例：
  - 000001: 华夏成长混合
  - 000002: 华夏成长混合(后端)
  - 其他公募基金代码

## 注意事项

1. **数据时效性**
   - 基金持仓数据有延迟（季度更新）
   - 股票数据为实时数据
   - 估算结果仅供参考

2. **交易时间**
   - 股票价格仅在交易时间内实时更新
   - 非交易时间显示收盘价

3. **API限制**
   - 避免过于频繁的请求
   - 如遇到限流，请稍后再试

4. **数据准确性**
   - 估算基于最新披露的持仓数据
   - 实际持仓可能已发生变化
   - 基金实际涨跌幅与估算可能存在差异

## 技术栈

- **前端**: Vue 3 + Vite + Tailwind CSS
- **后端**: Python + Flask + AkShare
- **数据源**: 天天基金网、东方财富网

## 故障排查

### 问题1: 无法获取基金持仓
- 检查基金代码是否正确（6位数字）
- 查看后端日志，确认API调用情况
- 某些基金可能暂无持仓数据

### 问题2: 无法获取股票价格
- 检查网络连接
- 确认是否为交易时间
- 查看后端日志，确认API调用情况

### 问题3: 估算结果异常
- 确认持仓数据和股票数据都已获取
- 检查持股数量和持仓市值
- 参考后端日志排查问题

## 扩展功能建议

1. **历史数据**: 添加历史净值和持仓查询
2. **持仓对比**: 展示持仓变化趋势
3. **收益计算**: 根据持仓计算预估收益
4. **数据图表**: 可视化展示涨跌幅趋势
5. **预警功能**: 涨跌幅超过阈值时提醒

## 相关链接

- [AkShare官方文档](https://akshare.akfamily.xyz/)
- [天天基金网](https://fund.eastmoney.com/)
- [东方财富网](https://quote.eastmoney.com/)
